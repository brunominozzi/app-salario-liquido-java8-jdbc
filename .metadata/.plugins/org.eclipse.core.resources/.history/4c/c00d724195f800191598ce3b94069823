package com.ccee.projetotestejava.main;

import java.util.Comparator;
import java.util.List;
import java.util.stream.Collectors;

import com.ccee.projetotestejava.dao.DescontosDao;
import com.ccee.projetotestejava.dao.FuncionarioDao;
import com.ccee.projetotestejava.exception.DaoException;
import com.ccee.projetotestejava.model.DescontosBean;
import com.ccee.projetotestejava.model.FuncionarioBean;

/**
 * Classe Main que contém aplicação responsável pelo processo de Calculo de 
 * salário liquido dos Funcionarios
 * 
 * @author bruno.minozzi
 * @since 27/10/2019
 *
 */
public class CalculoSalarioLiquidoFuncionarios {
	
	static FuncionarioDao funcionarioDao = null;
	
	static DescontosDao descontosDao = null;
	
	@SuppressWarnings("static-access")
	private CalculoSalarioLiquidoFuncionarios() {
		this.funcionarioDao = new FuncionarioDao();
		this.descontosDao = new DescontosDao();
	}
	
	/**
	 * Método main com run principal para execução do sistema CalculoSalarioLiquidoFuncionarios
	 * @param args
	 */
	public static void main(String[] args) {

		try {
			List<FuncionarioBean> listaFuncionarios = obterFuncionarios();
			List<DescontosBean> listaDescontos = obterDescontos();
			for (FuncionarioBean funcionarioBean : listaFuncionarios) {
				for (DescontosBean descontosBean : listaDescontos) {
					if(funcionarioBean.getIdFuncionario() == descontosBean.getIdFuncionario()) {
						funcionarioBean.getValorSalarioBruto().subtract(descontosBean.getValorDesconto());
					}
				}
			}
			listaFuncionarios.sort(Comparator.comparing(FuncionarioBean::getValorSalarioBruto));
			System.out.println(listaFuncionarios.toString());
			
		} catch (DaoException e) {
			System.err.println("Falha na Execução de CalculoSalarioLiquidoFuncionarios" + e.getMessage());
		}
		
	}
	
	/**
	 * Método que encapsula busca de funcionarios
	 * @return
	 * @throws DaoException
	 */
	public static List<FuncionarioBean> obterFuncionarios() throws DaoException{
		return funcionarioDao.getListaFuncionarios();
	}
	
	/**
	 * Método que encapsula busca de descontos
	 * @return
	 * @throws DaoException
	 */
	public static List<DescontosBean> obterDescontos() throws DaoException{
		return descontosDao.getListaDescontos();
	}

}
