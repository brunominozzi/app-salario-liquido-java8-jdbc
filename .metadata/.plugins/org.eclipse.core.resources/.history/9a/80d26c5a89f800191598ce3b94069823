package com.ccee.projetotestejava.dao;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import com.ccee.projetotestejava.exception.DaoException;
import com.ccee.projetotestejava.model.Funcionario;

/**
 * Classe Dao responsável pelos acessos a tabela 'funcionario'
 * 
 * @author bruno.minozzi
 * @since 26/10/2019
 *
 */
public class FuncionarioDao extends AbstractDao {
    
    /**
     * Método responsável por retornar lista de Objeto 'Descontos'
     * @return List<Descontos>
     * @throws FuncionarioDaoException 
     */
    public List<Funcionario> getListaFuncionarios() throws DaoException {
        List<Funcionario> funcionarios = new ArrayList<Funcionario>();
        try {
            PreparedStatement stmt = this.getConnection().
                    prepareStatement("select * from funcionario");
            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
            	Funcionario funcionario = new Funcionario();
            	funcionario.setIdFuncionario(rs.getInt("id_funcionario"));
            	funcionario.setNomeCliente(rs.getString("nm_cliente"));
            	funcionario.setValorSalarioBruto(rs.getBigDecimal("nm_cliente"));

            	funcionarios.add(funcionario);
            }
            rs.close();
            stmt.close();
            
        } catch (SQLException e) {
        	throw new RuntimeException(e.getMessage(), e.getCause());
        }finally{
        	this.closeConnection();
        }
        return funcionarios;
    }

}