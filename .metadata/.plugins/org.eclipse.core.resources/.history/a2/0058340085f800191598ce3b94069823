package com.ccee.projetotestejava.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import com.ccee.projetotestejava.exception.FuncionarioDaoException;
import com.ccee.projetotestejava.factory.ConnectionDataFactory;
import com.ccee.projetotestejava.model.Funcionario;

/**
 * Classe Dao responsável pelos acessos a tabela 'funcionario'
 * 
 * @author bruno.minozzi
 * @since 26/10/2019
 *
 */
public class FuncionarioDao {

    private Connection connection;

    public FuncionarioDao() {
        this.connection = new ConnectionDataFactory().getConnection();
    }
    
    /**
     * Método responsável por retornar lista de Objeto 'Descontos'
     * @return List<Descontos>
     */
    public List<Funcionario> getListaFuncionarios() {
    	List<Funcionario> funcionarios = new ArrayList<Funcionario>();
    	PreparedStatement stmt = null;
    	ResultSet rs = null;
        try {
            stmt = this.connection.
                    prepareStatement("select * from funcionario");
            rs = stmt.executeQuery();

            while (rs.next()) {
            	Funcionario funcionario = new Funcionario();
            	funcionario.setIdFuncionario(rs.getInt("id_funcionario"));
            	funcionario.setNomeCliente(rs.getString("nm_cliente"));
            	funcionario.setValorSalarioBruto(rs.getBigDecimal("nm_cliente"));

            	funcionarios.add(funcionario);
            }
        } catch (SQLException e) {
        	throw new FuncionarioDaoException(e.getMessage(), e.getCause());
        }finally {
            rs.close();
            stmt.close();
		}
        return funcionarios;
    }
}